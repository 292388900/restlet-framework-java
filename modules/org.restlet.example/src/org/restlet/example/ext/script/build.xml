<?xml version="1.0"?>

<project name="Restlet Script Extension Example" default="build">

	<!--<property name="root" value="../../../../../../.." />
	<property name="lib" value="${trunk}/lib" />-->

	<property name="trunk" value="../../../../../../../.." />
	<property name="lib" value="${trunk}/libraries" />
	<property name="lib-dist" value="${trunk}/build/dist/classic/restlet-1.2snapshot/lib" />

	<property name="lib-scripturian" value="${lib}/com.threecrickets.scripturian_1.0" />
	<property name="lib-json" value="${lib}/org.json_2.0" />
	<property name="lib-jsr223" value="${lib}/jaxax.script_1.0" />
	<property name="lib-rhino" value="${lib}/org.mozilla.rhino_1.7" />
	<property name="lib-quercus" value="${lib}/com.caucho.quercus_3.2" />
	<property name="lib-servlet" value="${lib}/javax.servlet_2.5" />
	<property name="lib-jython" value="${lib}/org.python_2.2" />
	<property name="lib-jruby" value="${lib}/org.jruby_1.2" />
	<property name="lib-groovy" value="${lib}/org.codehaus.groovy_1.6" />
	<property name="lib-velocity" value="${lib}/org.apache.velocity_1.5" />
	<property name="lib-commons-lang" value="${lib}/org.apache.commons.lang_2.3" />
	<property name="lib-commons-collections" value="${lib}/org.apache.commons.collections_3.2" />

	<target name="lib-restlet" description="Fetch Restlet libraries">
		<copy todir="jar/restlet/" flatten="true">
			<file file="${lib-dist}/org.restlet.jar" />
			<file file="${lib-dist}/org.restlet.ext.script.jar" />
			<file file="${lib-scripturian}/com.threecrickets.scripturian.jar" />
			<file file="${lib-dist}/org.restlet.ext.json.jar" />
			<file file="${lib-json}/org.json.jar" />
		</copy>
	</target>

	<target name="lib-scripting" description="Fetch scripting libraries">
		<copy tofile="jar/scripting/jython.jar" flatten="true">
			<file file="${lib-jython}/org.python.jar" />
		</copy>
		<copy todir="jar/scripting/" flatten="true">
			<file file="${lib-jsr223}/javax.script.jar" />

			<file file="${lib-rhino}/org.mozilla.rhino.jar" />
			<file file="${lib-rhino}/com.sun.phobos.script.jar" />

			<file file="${lib-quercus}/com.caucho.quercus.jar" />
			<file file="${lib-quercus}/com.caucho.resin.util.jar" />
			<file file="${lib-servlet}/javax.servlet.jar" />

			<file file="${lib-jython}/com.sun.script.jython.jar" />

			<file file="${lib-jruby}/org.jruby.jar" />
			<file file="${lib-jruby}/com.sun.script.jruby.jar" />

			<file file="${lib-groovy}/org.codehaus.groovy.jar" />

			<file file="${lib-velocity}/org.apache.velocity.jar" />
			<file file="${lib-velocity}/com.sun.script.velocity.jar" />
			<file file="${lib-commons-lang}/org.apache.commons.lang.jar" />
			<file file="${lib-commons-collections}/org.apache.commons.collections.jar" />
		</copy>
		<copy todir="jar/scripting/Lib">
			<fileset dir="${lib-jython}/Lib/" />
		</copy>
	</target>

	<target name="libraries" depends="lib-restlet, lib-scripting" description="Fetch all libraries" />

	<target name="package" depends="libraries" description="Zip">
		<zip destfile="scripted-restlet-distribution.zip" basedir="." includes="*.txt, run.*, main.script, conf/, resources/, web/, jar/" excludes="jar/scripting/cachedir/, resources/jython/*.class" />
	</target>

	<target name="build" depends="package" description="Build distribution">
	</target>

	<target name="clean" description="Clean">
		<delete dir="jar" />
		<delete file="scripted-restlet-distribution.zip" />
	</target>

	<target name="rebuild" depends="clean, build" description="Clean and build distribution">
	</target>

</project>