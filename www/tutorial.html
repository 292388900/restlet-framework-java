<html>
<head>
 <style type="text/css">
/* <![CDATA[ */
@import "http://www.tigris.org/branding/css/tigris.css";
@import "http://www.tigris.org/branding/css/inst.css";
/*  ]]> */
 </style>
  <link rel="stylesheet" type="text/css" href="http://www.tigris.org/branding/css/print.css" media="print" />
<script src="http://www.tigris.org/branding/scripts/tigris.js" type="text/javascript">
</script>
 <title>Restlet - Tutorial</title>
</head>
<body>

<a target="_top" href="http://www.restlet.org"><img src="images/logo200.gif"/></a><br/>

<br/>

<h1>Tutorial</h1>

<h3>1. Registering the Restlet implementation</h3>

<p>
   The Restlet framework is composed of two parts. First, there is the "Restlet API", a neutral API supporting the concepts of REST and a mechanism called Restlet facilitating the handling of REST calls. This API must be supported by a "Restlet Implementation" before it can be effectively used. Multiple providers could provide an implementation (open source projects, commercial products).
</p>
<p>
   This separation between the API and the implementation is similar to the one between the Servlet API and your preferred Web container or Servlet engine, or between the JDBC API and your JDBC driver.
</p>
<p>
   Currently, only the Reference Implementation (RI) is available, the "Noelios Restlet Engine" (NRE), which is by the way an open source project. When you download the Restlet framework, the API and the NRE come bundled together, ready to be used. You only need to add the following line before working with the framework:
</p>
<pre>
   com.noelios.restlet.Engine.register();
</pre>
<p>
   Internally, the NRE registers itself as the current implementation by calling back <code>org.restlet.Manager.registerFactory()</code>, passing a new instance of itself as a parameter.
</p>

<h3>2. Retrieving the content of a Web page</h3>

<p>
   As we mentionned in the introduction paper, the Restlet framework is at the same time a client and server framework. For example, NRE can easily work with remote resources using its HTTP client connector. A connector in REST, is a sofware component that enables the communication between resources, typically by implementing one side of a network protocol. Here we will get the representation of an existing resource and output it in the JVM console:
</p>
<pre>
   import com.noelios.restlet.connector.HttpClient;

   try
   {
      HttpClient client = new HttpClient("My Web client");
      client.doGet("http://www.restlet.org").write(System.out);
   }
   catch(IOException e)
   {
      e.printStackTrace();
   }
</pre>
<p>
   Note that the example above uses a simplified way to issue calls via the HttpClient. A more flexible way is to create a new REST call and to ask the HTTP client to handle it. The Manager class also has a factory role ; it is a neutral access point to the registered Restlet implementation. The example below could be a good basis to set some preferences in your call, like the languages or media types you prefer to receive as a response:
</p>
<pre>
   import java.io.IOException;
   import org.restlet.Manager;
   import org.restlet.UniformCall;
   import org.restlet.data.Methods;
   import org.restlet.data.Reference;
   import org.restlet.data.Representation;
   import com.noelios.restlet.connector.HttpClient;

   try
   {
      // Prepare the REST call
      UniformCall call = Manager.createCall();
      Reference uri = Manager.createReference("http://www.restlet.org");
      call.setResourceUri(uri);
      call.setMethod(Methods.GET);

      // Ask to the HTTP client connector to handle the call
      HttpClient client = new HttpClient("My Web client");
      client.handle(call);

      // Output the result representation on the JVM console
      Representation output = call.getOutput();
      output.write(System.out);
   }
   catch(IOException e)
   {
      e.printStackTrace();
   }
</pre>

<h3>3. Listening to Web browsers</h3>

<p>
   Now, we want to see how the Restlet framework can listen to client requests and reply to them. We will use the NRE HTTP server connector (supported by Mortbay's Jetty HTTP listener) and return a simple string representation "Hello World!" as plain text.
</p>

<pre>
   import org.restlet.UniformCall;
   import org.restlet.UniformInterface;
   import org.restlet.data.MediaTypes;

   import com.noelios.restlet.data.StringRepresentation;
   import com.noelios.restlet.ext.jetty.JettyServer;

   // Creating a minimal handler returning "Hello World"
   UniformInterface handler = new UniformInterface()
   {
      public void handle(UniformCall call)
      {
         call.setOutput(new StringRepresentation("Hello World!", MediaTypes.TEXT_PLAIN));
      }
   };

   // Create the HTTP server and listen on port 8182
   JettyServer server = new JettyServer("My Web server", 8182, handler);
   server.start();
</pre>

<p>
   If you run this code and launch your server, you can open a Web browser and hit the <a target="_top" href="http://localhost:8182">http://localhost:8182</a>. Actually, any URI will work, try also <a target="_top" href="http://localhost:8182/test/tutorial">http://localhost:8182/test/tutorial</a>. The handler that we created is very primitive because it only uses the pure REST part of the Restlet framework. We will see next, how to take advantage of the Restlets and Maplets components.
</p>

<h3>4. Restlets servers and containers</h3>
<p>
   First, let's consider a typical architecture from a REST point of view. In the diagram below, circles represent the connector that enable the communication between components which are represented by the boxes. The blue links represents the network communication using a particular protocol (HTTP, SMTP, etc.). Note that the same component can have any number of client and server connectors attached to it. Web Server B, for example, has both a server connector to respond to requests from the User Agent component, and client connectors to send requests to the Database Server, the Mail Server and the Web Server A.
</p>
<p>
   <img src="images/rest-architecture.gif"/>
</p>
<p>
   In addition to supporting the REST software architecture elements presented before, we can also use Restlets which are handlers of calls to resources which live inside a parent container (called a Restlet container) and are selected by parsing the resource's URI.
</p>
<p>
   Maplets are a kind of Restlets that can have other Restlets attached to them and that can automatically delegate calls to them based on a URI pattern. See below how multiple Restlet containers can live within a Restlet server. For example, this is very useful if you want to separate you domain resources (managed by container C) from your web server resources (managed by container A) and your web services resources (managed by container B).
</p>
<p>
   Also, note that servers and containers are REST components themselves. This means that if your Restlet server has only one container, you can simply use it as your origin server and attach connectors normally.
</p>
<p>
   <img src="images/restlet-server.gif"/>

</p>

<h3>4. Serving static files</h3>
<p>
   Show the usage of the DirectoryRestlet with content negotiation (language).
</p>

<p>
   <a href="mailto:contact@noelios.com">J&eacute;r&ocirc;me Louvel</a> (<a target="_top" href="http://noelios.wordpress.com">blog</a>)<br/>
</p>

<br/>

<small>
   Version 0.3, last modified on 2005/12/02<br/>
   Copyright &copy; 2005 J&eacute;r&ocirc;me Louvel. Restlet is a trademark and service mark of <a target="_top" href="http://www.noelios.com/en">Noelios Consulting</a>.
</small>

</body>
</html>
